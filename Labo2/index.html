<!DOCTYPE>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="style.css">
    <title>Search</title>
</head>
<body id="body">


    <div id="search" onclick="input()">
        <input placeholder="Search..." type="search" id="input" oninput="input()">
        <div id="result">

        </div>
    </div>
<script>
    var indexAnswer = 0;
    var data;
    var arrData = [];
    var numResult = 0;



    for(page = 1; page < 10; page++){
        const request = new XMLHttpRequest();
        const url='https://swapi.co/api/people/?page=' + page + '&format=json';
        request.open("GET", url, true);
        request.send();

        request.onloadend = () => {
            data = JSON.parse(request.response);
            console.log(typeof data);
            for(var i = 0; i < data["results"].length; i++){
                arrData.push(data["results"][i]);
            }
        }
    }


    function autoComplete(response){
        document.getElementById('input').value = response.innerText;
    }

    function input() {
        var input = document.getElementById("input").value;
        var results = document.getElementById('result');
        var re = new RegExp(input, 'i');

        indexAnswer = 0;
        numResult = 0;
        var uniqueResult = false;
        results.innerHTML = '';

        for (var i in arrData) {
            if(input == arrData[i]['name']){
                uniqueResult = true;
                numResult = 1;
            }
            else if (arrData[i]['name'].search(re) != -1) {
                results.innerHTML += "<div class='results' onclick='autoComplete(this)'>" + arrData[i]['name'] + "</div>";
                numResult++;
            }
        }

        if (uniqueResult){
            results.innerHTML = '';
        }
        else{
            console.log(indexAnswer);
            results.childNodes[indexAnswer].style = "background-color: grey;";
        }
    }



    document.addEventListener("keyup", function(event) {
        var results = document.getElementById('result');
        if (event.keyCode === 13) {
            document.getElementById('input').value = results.childNodes[indexAnswer].innerText;
            document.getElementById('result').innerHTML = '';
        }
        else if(event.keyCode === 38 && indexAnswer > 0) {
            results.childNodes[indexAnswer].style = "background-color: white;";
            indexAnswer--;
            results.childNodes[indexAnswer].style = "background-color: grey;";
        }
        else if(event.keyCode === 40 && indexAnswer < numResult) {
            results.childNodes[indexAnswer].style = "background-color: white;";
            indexAnswer++;
            results.childNodes[indexAnswer].style = "background-color: grey;";
        }
    });


</script>
</body>
</html>